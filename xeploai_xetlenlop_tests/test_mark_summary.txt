*** Settings ***
Documentation     Kiểm thử Module tính điểm trung bình cả năm, xét học lực
...				  dựa vào điểm tổng kết các môn học, hạnh kiểm
...               của học sinh

Resource          resource.txt

*** Test Cases ***
Kiem Tra Bang tong ket Diem, Thi Dua va Xep Loai
    [SetUp]		Login To System
	
	Goto Class Manager
	Goto Mark Summary
	
	Test Mark Summary Table
	
	[Teardown]    Close Browser

*** Variables ***
${START ROW}	3					

*** Keywords ***
#Test Tính điểm trung bình chung, Xếp loại và Danh hiệu của tất cả học sinh
Test Mark Summary Table
	${END ROW}=		add		${START ROW}	${NUMBER OF STUDENTS}
	Set Test Variable	${TR CLASS NAME}	27900					#Tên class tr đầu tiên-dòng đầu tiên chứa dữ liệu
	Set Test Variable	${HANHKIEM CLASS NAME}	"input-mini hk"		#Tên class input chứa Hạnh kiểm
	
	Set Test Variable	${DIEM DAT}		"Đ"							#Điểm đánh giá thể dục
	Set Test Variable	${DIEM CHUA DAT}	"CĐ"
	
	:FOR	${rowNumber}	IN RANGE	${START ROW} 	${END ROW}
	\		${Hanh Kiem}=	Get Value	xpath=//tr[@class="${TR CLASS NAME}"]/td/input[@class=${HANHKIEM CLASS NAME}]
	\		${Diem The Duc}=	Get Table Cell		mark-table		${rowNumber}	16
	\		${Diem Part 1}=		Get Mark	${rowNumber}	5	16
	\		${Diem Part 2}=		Get Mark	${rowNumber}	17	19
	\		${Bang Diem}=	Create List  	#Bảng điểm
	\		${Bang Diem}=	Combine Lists	${Diem Part 1}	${Diem Part 2}
	
	#Test điểm trung bình chung
	\		${This Average}=		Get Table Cell		mark-table		${rowNumber}	19
	\		Test Mark Average	${Bang Diem}		${This Average}
	
	#Xét Học lực
	\		${Expected Hoc Luc}=		Xet Hoc Luc		${Diem The Duc}		${This Average}		${Bang Diem}
	\		${This Hoc Luc}=	Get Table Cell		mark-table		${rowNumber}	20
	\		Should Be Equal		${This Hoc Luc}	 	${Expected Hoc Luc}
	
	#Xét Danh hiệu
	\		${Expected Danh Hieu}=		Xet Danh Hieu	${Expected Hoc Luc}	  ${Hanh Kiem}
	\		${This Danh Hieu}=	Get Table Cell		mark-table		${rowNumber}	22
	\		Should Be Equal		${This Danh Hieu}	${Expected Danh Hieu}
	
	#Xét biến cho vòng lặp sau
	\		${TR CLASS NAME}= 	add		${TR CLASS NAME}	1

#Test Tính điểm trung bình chung của 1 học sinh
Test Mark Average
	[Arguments]		${Diem}		${thisAvg}
	${expectedAvg}=		Calculate Average	${Diem}
	${thisAvg}=		Convert To Number	${thisAvg}
	Should Be Equal		${thisAvg}		${expectedAvg}

#Lấy điểm các môn trong 1 dòng
Get Mark
	[Arguments]		${rowNumber}	${beginColumn}		${endColumn}
	[Return]	${row}
	${row}=	Create List
	:FOR	${columnNumber}		IN RANGE	${beginColumn}		${endColumn}
	\		${value}=	Get Table Cell		mark-table		${rowNumber}	${columnNumber}
	\		Append To List	 ${row}	${value}

#Tính điểm trung bình
Calculate Average
	[Return]	${avg}
	[Arguments]		${list}
	${avg}=		avgs	${list}
		
#Xét Học lực của 1 học sinh
Xet Hoc Luc
	[Arguments]		${Diem The Duc}		${This Average}		${thisDiem}
	[Return]	${Hoc luc}
	${Hoc luc}=		Tinh Hoc Luc	${Diem The Duc}		${This Average}		${thisDiem}

#Xét danh hiệu Tiên tiến, Khá giỏi
Xet Danh Hieu
	[Arguments]		${Hoc luc} 	${Hanh kiem}
	[Return]	${Danh hieu}
	${Danh hieu}= 	Tinh Danh Hieu	${Hoc luc}	${Hanh kiem}